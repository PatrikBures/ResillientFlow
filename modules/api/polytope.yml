tools:
  api:
    info: "Runs the backend API server for logistics workflow orchestration"
    run:
      - tool: polytope/container
        args:
          image: node:18-alpine
          id: api
          restart:
            policy: on-failure
          services:
            - id: api
              ports:
                - {protocol: http, port: 5000, expose-as: 5000}
          mounts:
            - path: /app
              source:
                type: host
                path: ../../mysterybox-backend
          workdir: /app
          env:
            - {name: TEMPORAL_GRPC_ENDPOINT, value: "temporal:7233"}
          cmd:
            - sh
            - -c
            - "npm install && npm run build && node dist/server.js"
          create: when-missing
